# Base audit entity properties - matches BaseAuditEntity exactly
AuditModel:
  type: object
  title: AuditModel
  description: Base audit properties matching BaseAuditEntity
  properties:
    createdAt:
      type: string
      format: date-time
      description: "Creation timestamp"
      readOnly: true
    updatedAt:
      type: string
      format: date-time
      description: "Last update timestamp"
      readOnly: true

# Base schema with common client properties - matches ClientEntity
ClientBase:
  allOf:
    - $ref: '#/AuditModel'
    - type: object
      title: ClientBase
      description: Base schema for client properties based on ClientEntity
      properties:
        id:
          type: integer
          format: int64
          description: "Unique client identifier"
        version:
          type: integer
          format: int32
          description: "Entity version for optimistic locking"
        clientName:
          type: string
          description: "Client name"
          maxLength: 255
        clientNumber:
          type: string
          description: "Unique client number"
          maxLength: 50
        lastUpdateUserId:
          type: integer
          format: int64
          description: "ID of user who last updated the client"
        deleted:
          type: boolean
          description: "Whether client is deleted"
          default: false

# Complete Client DTO - matches ClientEntity structure
ClientSummaryDto:
  allOf:
    - $ref: '#/ClientBase'
    - type: object
      title: ClientSummaryDto
      description: Complete client information matching ClientEntity
      required:
        - id
        - clientName
        - clientNumber
      properties:
        externalReferences:
          type: array
          items:
            $ref: '#/ExternalReference'
          description: "List of external reference identifiers"

# Create/Update Client DTO - for API operations
Client:
  allOf:
    - $ref: '#/ClientBase'
    - type: object
      title: Client
      description: Complete client model for create/update operations
      required:
        - clientName
        - clientNumber
      properties:
        externalReferences:
          type: array
          items:
            $ref: '#/ExternalReference'
          description: "List of external reference identifiers"

# Filter extends base for searching
ClientSummaryFilter:
  allOf:
    - $ref: '#/ClientBase'
    - type: object
      title: ClientSummaryFilter
      description: Filter criteria for searching clients
      properties:
        # Override descriptions for filter context
        clientName:
          type: string
          description: "Filter by client name (partial match)"
        # Additional filter-specific fields
        externalReferenceType:
          type: string
          description: "Filter by external reference type"
        externalReferenceValue:
          type: string
          description: "Filter by external reference value"
        minVersion:
          type: integer
          format: int32
          description: "Minimum version number"
        maxVersion:
          type: integer
          format: int32
          description: "Maximum version number"
        # Pagination fields
        page:
          type: integer
          format: int32
          default: 0
          minimum: 0
          description: "Page number (0-indexed)"
        size:
          type: integer
          format: int32
          default: 20
          minimum: 1
          maximum: 100
          description: "Page size"
        # Sorting fields
        sortBy:
          type: string
          description: "Field to sort by"
          default: "id"
        sortDirection:
          type: string
          enum: [ASC, DESC]
          description: "Sort direction"
          default: "DESC"

# External reference base properties - matches ExternalReferenceEntity
ExternalReferenceBase:
  type: object
  title: ExternalReferenceBase
  description: Base properties for external references
  properties:
    externalReferenceType:
      type: string
      description: "Type of external reference"
      maxLength: 100
    externalReferenceValue:
      type: string
      description: "Value of external reference"
      maxLength: 255
    lastUpdateUserId:
      type: integer
      format: int64
      description: "ID of user who last updated this reference"
    deleted:
      type: boolean
      description: "Whether this reference is deleted"
      default: false

# Complete ExternalReference DTO - matches ExternalReferenceEntity structure
ExternalReference:
  allOf:
    - $ref: '#/ExternalReferenceBase'
    - type: object
      title: ExternalReference
      description: External reference for a client matching ExternalReferenceEntity
      required:
        - externalReferenceType
        - externalReferenceValue

# Page response for clients
ClientPage:
  type: object
  title: ClientPage
  description: Paginated client search results
  required:
    - content
    - totalPages
    - totalElements
    - size
    - number
    - first
    - last
    - empty
  properties:
    content:
      type: array
      items:
        $ref: '#/ClientSummaryDto'
      description: List of clients
    totalPages:
      type: integer
      format: int32
      description: Total number of pages
    totalElements:
      type: integer
      format: int64
      description: Total number of elements
    size:
      type: integer
      format: int32
      description: Current page size
    number:
      type: integer
      format: int32
      description: Current page number
    first:
      type: boolean
      description: Is this the first page
    last:
      type: boolean
      description: Is this the last page
    empty:
      type: boolean
      description: Is the content empty